<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="PowerPad.WinUI.Components.Controls.AgentControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:PowerPad.WinUI.Components.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:converters="using:CommunityToolkit.WinUI.Converters"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    mc:Ignorable="d">
    <UserControl.Resources>
        <converters:EmptyObjectToObjectConverter x:Key="EmptyObjectToObjectConverter" EmptyValue="Collapsed" NotEmptyValue="Visible" />
    </UserControl.Resources>
    <Grid>
        <StackPanel 
            x:Name="AgentPanel"
            Orientation="Vertical" 
            Spacing="4">
            <Grid
                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                Padding="16"
                CornerRadius="10"
                ColumnSpacing="8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="auto" />
                </Grid.ColumnDefinitions>
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <DropDownButton x:Name="AgentButton" Height="32" ToolTipService.ToolTip="Modelo">
                        <DropDownButton.Flyout>
                            <MenuFlyout x:Name="AgentFlyoutMenu" Placement="TopEdgeAlignedLeft">
                            </MenuFlyout>
                        </DropDownButton.Flyout>
                        <DropDownButton.Content>
                            <StackPanel Orientation="Horizontal">
                                <ContentControl x:Name="ModelIcon" />
                                <TextBlock x:Name="ModelName" MaxWidth="150" TextTrimming="CharacterEllipsis" Margin="8,0,0,0" />
                            </StackPanel>
                        </DropDownButton.Content>
                    </DropDownButton>
                </StackPanel>

                <local:IntegratedTextBox
                    x:Name="PromptParameterInputBox"
                        Grid.Column="1"
                    TextWrapping="Wrap" 
                    MaxHeight="148"
                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                    Padding="4"
                    FontSize="16"
                    KeyDown="PromptParameterInputBox_KeyDown"
                    TextChanged="PromptParameterInputBox_TextChanged"/>

                <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button x:Name="SendButton"
                        Click="SendBtn_Click"
                        Style="{StaticResource AccentButtonStyle}"
                        Height="32"
                        BorderThickness="0"
                        IsEnabled="False">
                        <StackPanel Orientation="Horizontal">
                            <FontIcon FontSize="20" Glyph="&#xE725;" />
                        </StackPanel>
                    </Button>
                    <Button x:Name="StopButton"
                        Style="{ThemeResource AccentButtonStyle}"
                        Visibility="Collapsed"
                        Height="32"
                        BorderThickness="0"
                        Click="StopBtn_Click">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon FontSize="20" Glyph="&#xE73B;" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
            <TextBlock 
                Text="El contenido generado por inteligencia artificial puede contener errores." 
                VerticalAlignment="Stretch"
                TextAlignment="Center"
                Foreground="{ThemeResource TextFillColorTertiaryBrush}"
                FontSize="12"
                Height="18" />
        </StackPanel>
        <muxc:InfoBar 
            x:Name="InfoBar"
            Severity="Informational"
            IsClosable="False" />
    </Grid>
</UserControl>
